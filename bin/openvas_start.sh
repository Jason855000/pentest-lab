#!/usr/bin/env bash
sudo -s
test -e /var/lib/openvas/CA/cacert.pem  || openvas-mkcert -q
openvas-nvt-sync
test -e /var/lib/openvas/users/om || openvas-mkcert-client -n om -i
/etc/init.d/openvas-manager stop
/etc/init.d/openvas-scanner stop
openvassd
openvasmd --migrate
openvasmd --rebuild
killall openvassd
sleep 15
/etc/init.d/openvas-scanner start
/etc/init.d/openvas-manager start
/etc/init.d/openvas-administrator restart
/etc/init.d/greenbone-security-assistant restart
test -e /var/lib/openvas/users/admin || openvasad -c add_user -n admin -r Admin
#openvasmd --user=admin --new-password=1234

## Script by AfterBurn @ NetSecNow GNU License
printf -e "Script by AfterBurn @ NetSecNow.\n"
##Setting up nvt sync
printf "Syncing NVT Database..."
openvas-nvt-sync
printf "Updating SCAP Data Feed"
openvas-scapdata-sync
printf "Updating CERT Feed.."
openvas-certdata-sync
## Starting Services
printf "Starting OpenVAS Services..."
/etc/init.d/./greenbone-security-assistant start
/etc/init.d/./openvas-scanner start
/etc/init.d/./openvas-administrator start
/etc/init.d/./openvas-manager start